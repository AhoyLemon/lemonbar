.drinks-page
  .container

    .header-section
      hgroup
        h1 All Drinks
        p Explore cocktail potentials from the ingredients in {{barName}}.

    .error-banner(v-if="error")
      .error-icon ⚠️
      .error-content
        h3 Failed to Load Data
        p {{ error }}
        p.error-help Make sure you can access https://hirelemon.com/bar/api and check your browser's ad blocker settings.

    // Show search bar only when NOT searching
    .search-bar.drink-search-bar
      form(@submit.prevent="handleSearch")
        input(
          v-model="searchTerm"
          type="text"
          placeholder="Search for cocktails..."
        )
        button.submit(type="submit") Search
        template(v-if="isSearchActive && !isSearching")
          button.reset( type="button" @click="handleClearSearch") Clear Search

    // Search loading state
    .searching-drinks(v-if="isSearching" role="status" aria-live="polite" aria-label="Searching for drinks")
      .inside
        .loading-header(aria-hidden="true")
          .loader
          .text-wrapper
            span Searching
        //.animation-wrapper(aria-hidden="true")
          .loader
        .text-wrapper
          ul.steps(aria-label="Search progress")
            li.step(
              v-for="(step, index) in searchProgress"
              :key="index"
              :class="[step.status === 'complete' ? 'complete' : 'searching', step.status === 'complete' && step.count === 0 ? 'none-found' : '', step.status === 'complete' && step.count > 0 ? 'found' : '']"
              :aria-label="step.labels.searching"
            ) 
              span.searching(v-if="step.status === 'searching'") {{ step.labels.searching }}
              span.complete.none-found(v-else-if="step.status === 'complete' && step.count === 0") {{ step.labels.foundNone }}
              span.complete.found(v-else-if="step.status === 'complete' && step.count > 0") {{ step.labels.found.replace('{count}', step.count.toString()) }}

    // Search error banner
    .search-error-banner(v-if="searchError && isSearchActive")
      .error-icon ⚠️
      .error-content
        h3 Search Error
        p {{ searchError }}

    // Search results header with integrated search form
    .search-results-header(v-if="isSearchActive && !isSearching")
      .results-summary
        .results-info
          .results-count(v-if="searchResults.length > 0")
            | Showing {{ searchResults.length }} result{{ searchResults.length === 1 ? '' : 's' }} for "{{ currentSearchTerm }}"
          .no-results(v-else-if="!searchError")
            | No results found for "{{ currentSearchTerm }}"
        .results-actions
          .sort-dropdown(v-if="searchResults.length > 0")
            label(for="SortBy") Sort by:
            select(id="SortBy" v-model="sortBy")
              option(value="relevance") Relevance
              option(value="name") Name (A-Z)
              option(value="ingredient") Ingredient Match
          //button.reset(type="button" @click="handleClearSearch") Clear Search

    section.filters(v-if="!isSearchActive")
      .filter-buttons
        button.filter-btn(:class="{ active: filter === 'all' }" @click="filter = 'all'") All ({{ allDrinksCount }})
        button.filter-btn(:class="{ active: filter === 'nonAlcoholic' }" @click="filter = 'nonAlcoholic'") Non-Alcoholic ({{ getNonAlcoholicDrinks.length }})

      // Tag filter selector (moved below filter buttons)
      .tag-filters(v-if="tagOptions.length > 0")
        label Tag Filter:
        TagFilterSelect(v-model="tagFilter" :tags="tagOptions" :totalCount="filteredDrinks.length")

    .loading.fetching-drinks(v-if="loading" role="status" aria-live="polite" aria-label="Loading drinks data")
      .inside
        .loading-header(aria-hidden="true") Loading Drinks...
        .animation-wrapper(aria-hidden="true")
          .loader
        .text-wrapper
          ul.steps(aria-label="Loading progress")
            li(
              v-for="(step, index) in loadingSteps"
              :key="index"
              :class="step.status"
              :aria-label="step.text"
            ) {{ step.text }}

    .error(v-if="error") {{ error }}

    // Empty state for no search results
    .empty-state(v-if="isSearchActive && !isSearching && searchResults.length === 0")
      .empty-state-content
        h3 No drinks found.
        p We searched high and low, but couldn't find any drinks matching #[strong {{ currentSearchTerm }}].
        p.suggestion Try a different search term, or browse suggested drinks by clearing your search.
        button.clear-search-btn(@click="handleClearSearch") Clear Search & Browse

    // Only show drinks when NOT currently searching
    section.drinks-section(v-if="!isSearching && displayedDrinks.length > 0 && (filter !== 'beerWine' && filter !== 'fingers')")
      h2.section-title(v-if="!isSearchActive") Cocktails
      h2.section-title(v-else) Search Results
      .drinks-grid
        DrinkCard(
          v-for="drink in displayedDrinks"
          :key="drink.id"
          :drink="drink"
          :show-availability="true"
          :external="drink.external"
          :tenant="tenant"
          :search-term="isSearchActive ? currentSearchTerm : ''"
        )
      //.hydrate-btn-container
        button.hydrate-btn(@click="hydrateMoreCocktailDB") RANDOM! COCKTAILS!
.bottle-detail-page
  .container
    hgroup.with-back
      h1 {{ bottle?.name || 'Loading...' }}
      .button-holder
        NuxtLink.back-btn(:to="`/${tenant}/bottles`") ‚Üê Back to Bottles
      
    .content-grid(v-if="bottle")
      .bottle-info-section
        .bottle-image(v-if="bottle.image")
          img(:src="`${bottle.image}`" :alt="bottle.name")
        
        .bottle-details-card
          h3 Details
          .detail-rows
            .detail-row
              span.label Category:
              span.value {{ bottle.category }}
            .detail-row(v-if="bottle.baseSpirit && bottle.baseSpirit !== bottle.category")
              span.label Spirit:
              span.value {{ bottle.baseSpirit }}
            .detail-row(v-if="bottle.bottleSize")
              span.label Size:
              span.value {{ bottle.bottleSize }}
            .detail-row(v-if="bottle.abv")
              span.label ABV:
              span.value {{ bottle.abv }}%
            .detail-row(v-if="bottle.origin")
              span.label Origin:
              span.value {{ bottle.origin }}
            .detail-row(v-if="bottle.bottleState")
              span.label State:
              span.value {{ bottleStateLabel(bottle.bottleState) }}
            .detail-row
              span.label Status:
              span.value(:class="bottle.inStock ? 'in-stock' : 'out-of-stock'") {{ bottle.inStock ? 'In Stock' : 'Out of Stock' }}
            .detail-row(v-if="bottle.isFingers")
              span.label Serving:
              span.value Fingers 
            .detail-row(v-if="bottle.tags && bottle.tags.length")
              span.label Tags:
              .tags-list
                span.tag(v-for="tag in bottle.tags" :key="tag") {{ tag }}
      
      .drinks-section
        h3 {{ getHeadline() }}
        
        // Show finger options if this is a finger bottle
        .drinks-list(v-if="bottle.isFingers")
          .drink-list-item.fully-available
            .drink-thumbnail
              .no-image ü•É
            .drink-info
              .drink-name {{ bottle.name }}, Straight Up
              .drink-availability
                span.availability-label.fully-available Available
            NuxtLink.drink-view-btn(:to="`/${tenant}/drinks/finger-${bottle.id}-straight`") View
          .drink-list-item.fully-available
            .drink-thumbnail
              .no-image üßä
            .drink-info
              .drink-name {{ bottle.name }} On The Rocks
              .drink-availability
                span.availability-label.fully-available Available
            NuxtLink.drink-view-btn(:to="`/${tenant}/drinks/finger-${bottle.id}-rocks`") View
        
        // Show regular drinks if not a finger bottle
        template(v-else)
          // Loading state while searching
          .loading.fetching-drinks(v-if="searching")
            .loader-wrapper
              .loader
            p {{ searchingFor }}
            p.found-count(v-if="foundCount > 0") Found {{ foundCount }} drink{{ foundCount === 1 ? '' : 's' }} so far...
            button.stop-search(@click="stopSearch") Stop Search
          
          // Not searching anymore
          template(v-else)
            // Filter buttons (only show if we have multiple sources)
            .source-filters(v-if="showSourceFilters")
              button.filter-btn(:class="{ active: sourceFilter === 'all' }" @click="sourceFilter = 'all'") All
              button.filter-btn(:class="{ active: sourceFilter === 'local' }" @click="sourceFilter = 'local'") Local
              button.filter-btn(:class="{ active: sourceFilter === 'external' }" @click="sourceFilter = 'external'") CocktailsDB
            
            // Drinks list (show if we have drinks)
            .drinks-list(v-if="filteredDrinks.length > 0")
              .drink-list-item.drink-card(
                v-for="drink in filteredDrinks"
                :key="drink.id"
                :class="{ 'has-missing-ingredients': !drinkHasAllIngredients(drink), 'fully-available': drinkHasAllIngredients(drink) }"
              )
                .drink-thumbnail
                  img(v-if="drink.imageUrl" :src="drink.imageUrl" :alt="drink.name")
                  img(v-else-if="drink.image" :src="`/images/drinks/${drink.image}`" :alt="drink.name")
                  .no-image(v-else) üçπ
                .drink-info
                  .drink-name 
                    | {{ drink.name }}
                    //- span.source-badge(:class="getDrinkSourceClass(drink)" :title="getDrinkSourceTitle(drink)") {{ getDrinkSourceLabel(drink) }}
                    span.source-badge(v-if="isDrinkFromCocktailsDB(drink)" title="This drink is from TheCocktailDB") üì°
                  .drink-availability
                    span.availability-label(:class="{ 'fully-available': drinkHasAllIngredients(drink) }") {{ getAvailabilityLabel(drink) }}
                  .drink-matched-term(v-if="drink.matchedTerm")
                    small Matched: {{ drink.matchedTerm }}
                .view-btn-holder
                  NuxtLink.drink-view-btn(:to="`/${tenant}/drinks/${drink.id}`") View
              
              // Rate limit message if API failures occurred
              p.rate-limit-message(v-if="showRateLimitMessage") API rate limit hit. Some drinks may be missing from this list.
            
            // Empty state (no drinks found)
            p.no-drinks(v-else) No drinks found using this bottle. Try checking back later or explore other bottles!
    
    .loading(v-else-if="loading") Loading bottle details...
    .error(v-else-if="error") {{ error }}